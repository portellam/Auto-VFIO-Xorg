#!/bin/bash sh

#
# Filename:         bashlib-globals
# Description:      Process/library validation
# Author(s):        Alex Portell <github.com/portellam>
# Maintainer(s):    Alex Portell <github.com/portellam>
#

# <remarks> Using </remarks>
# <code>
    source bashlib-globals
    source bashlib-vars
# </code>

# <code>
    # <summary> Check if the command is active. </summary>
    # <param name="1"> string: the command </param>
    function IsActiveCommand
    {
        IsString $1 || return $?

        # <params>
        local var_command='ps -e | grep ${1}'
        local str_output=$( eval "${var_command}" )
        # </params>

        if ! IsString "${str_output}" &> /dev/null; then
            echo -e "${var_prefix_error} Process '${1}' is not active."
            return "${int_code_cmd_is_null}"
        fi

        return 0
    }

    # <summary> Check if the daemon is active or not. </summary>
    # <param name="1"> string: the command </param>
    function IsActiveDaemon
    {
        IsString $1 || return $?

        # <params>
        local var_command='systemctl status ${1} | grep "active"'
        local str_output=$( eval "${var_command}" )
        # </params>

        IsString "${var_command}" || return $?

        case $( eval "${var_command}" ) in
            *"failed"* | *"inactive"* )
                return "${int_code_partial_completion}"
                ;;

            * )
                return 1
                ;;
        esac

        return 0
    }

    # <summary> Check if the command is installed. </summary>
    # <param name="1"> string: the command </param>
    function IsInstalledCommand
    {
        IsString $1 || return $?

        if [[ $( command -v $1 ) != "/usr/bin/${1}" ]]; then
            echo -e "${var_prefix_error} Command '${1}' is not installed."
            return "${int_code_cmd_is_null}"
        fi

        return 0
    }

    # <summary> Check if the daemon is installed. </summary>
    # <param name="1"> string: the command </param>
    function IsInstalledDaemon
    {
        IsString $1 || return $?

        # <params>
        local var_command='systemctl status ${1} | grep -Eiv "not"'
        local str_output=$( eval "${var_command}" )
        # </params>

        if ! IsString "${str_output}"; then
            echo -e "${var_prefix_error} Daemon '${1}' is not installed."
            return "${int_code_cmd_is_null}"
        fi

        return 0
    }
# </code>
