#!/bin/sh
# Generated by 'portellam/VFIO-setup'
#
# WARNING: Any modifications to this file will be modified by 'VFIO-setup'
#
exec tail -n +3 $0
# This file provides an easy way to add custom menu entries.  Simply type the
# menu entries you want to add after this comment.  Be careful not to change
# the 'exec tail' line above.


menuentry "Debian GNU/Linux, with Linux 5.10.0-16-amd64 (VFIO, w/o IOMMU '1', w/ boot VGA: 'NVIDIA Corporation GP104 [GeForce GTX 1070]')"{
        load_video
        insmod gzio
        if [ x\$grub_platform = xxen ]; then insmod xzio; insmod lzopio; fi

        insmod part_gpt
        # set root fstype #
        # insmod ext2
        insmod ext2

        # set root by UUID #
        # Run 'df /' and 'blkid'
        # set root='/dev/disk/by-uuid/*'
        set root='/dev/disk/by-uuid/e6181209-5515-474a-9ee1-baa89c9d6b0d'

        if [ x$feature_platform_search_hint = xy ]; then
        search --no-floppy --fs-uuid --set=root e6181209-5515-474a-9ee1-baa89c9d6b0d
        fi

        echo 'Loading Linux 5.10.0-16-amd64 ...'
        linux /boot/vmlinuz-5.10.0-16-amd64 root=UUID=e6181209-5515-474a-9ee1-baa89c9d6b0d quiet splash systemd.restore_state=0 rfkill.default_state=1 video=efifb:off acpi=force apm=power_off iommu=1,pt amd_iommu=on intel_iommu=on rd.driver.pre=vfio-pci pcie_aspm=off kvm.ignore_msrs=1 default_hugepagesz=1G hugepagesz=1G hugepages=24 modprobe.blacklist=radeon,xhci_hcd,snd_ctx>
        echo 'Loading initial ramdisk ...'
        initrd /boot/initrd.img-5.10.0-16-amd64
}

menuentry "Debian GNU/Linux, with Linux 5.10.0-16-amd64 (VFIO, w/o IOMMU '12', w/ boot VGA: 'Cayman PRO [Radeon HD 6950]')"{
        load_video
        insmod gzio
        if [ x\$grub_platform = xxen ]; then insmod xzio; insmod lzopio; fi

        insmod part_gpt
        # set root fstype #
        # insmod ext2
        insmod ext2

        # set root by UUID #
        # Run 'df /' and 'blkid'
        # set root='/dev/disk/by-uuid/*'
        set root='/dev/disk/by-uuid/e6181209-5515-474a-9ee1-baa89c9d6b0d'

        if [ x$feature_platform_search_hint = xy ]; then
        search --no-floppy --fs-uuid --set=root e6181209-5515-474a-9ee1-baa89c9d6b0d
        fi

        echo 'Loading Linux 5.10.0-16-amd64 ...'
        linux /boot/vmlinuz-5.10.0-16-amd64 root=UUID=e6181209-5515-474a-9ee1-baa89c9d6b0d quiet splash systemd.restore_state=0 rfkill.default_state=1 video=efifb:off acpi=force apm=power_off iommu=1,pt amd_iommu=on intel_iommu=on rd.driver.pre=vfio-pci pcie_aspm=off kvm.ignore_msrs=1 default_hugepagesz=1G hugepagesz=1G hugepages=24 modprobe.blacklist=nvidia,xhci_hcd,xhci_hc>
        echo 'Loading initial ramdisk ...'
        initrd /boot/initrd.img-5.10.0-16-amd64
}